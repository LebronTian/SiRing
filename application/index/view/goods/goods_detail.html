 <!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
	<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
	<title>商品详情</title>
	<style type="text/css">
		.aui-bar-tab {
			position: static;
		}
		.search-input {
			height: 1.6rem;
			line-height: 1.6rem;
			background: #f5f5f5;
			border-radius: 30px;
			position: relative;
			font-family: "aui_iconfont" !important;
			text-align: left;
			padding-left: 1.5rem;
			color: #999999;
		}
		.search-input:after {
			position: absolute;
			left: 0;
			padding-left: 0.5rem;
			content: "\e615";
		}
		.goods_parts{
			display: flex;
			align-items: center;
			font-size: 12px;
			color: #000;
		}
		.goods_parts_img{
			display: inline-block;
			width: 20px;
			height: 20px;
			overflow: hidden;
			margin-right: 5px;
		}
		.goods_parts_img img{
			width: 100%;
			height: 100%;
		}
		.goods_parts_big_img{
			display: none;
			position: fixed;
			left: 0;
			top: 0;
			width: 100%;
			height: 100vh;
			background-color: #fff;
			z-index: 999;
		}
		.goods_parts_big_img a{
			position: absolute;
			right: 0;
			top: 0;
			font-size: 35px;
			color: #aaa;
			width: 40px;
			height: 40px;
			text-align: center;
			line-height: 40px;
		}
		.goods_parts_big_img div{
			margin-top: 40px;
			width: 100%;
			height: auto;
			overflow-y: scroll;
		}
		.goods_parts_big_img div img{
			width: 100%;
			height: auto;
		}
		.aui-card-list{
			overflow-x: scroll;
			overflow-y: hidden;
			height: 65px;
		}
		.aui-card-list img{
			max-width: initial;
		}
		.tabClick{
			display: none;
			width: 100%;
			height: 40px;
			position: fixed;
			top: 0;
			left: 0;
			z-index: 998;
			background-color: rgba(200, 200, 200, .3);
		}
		.aui-border-t{
			display: flex !important;
			justify-content: space-around;
			align-items: center;
			height: 55px;
		}
		.aui-text-white{
			height: 36px;
			line-height: 36px;
			padding: 0 20px;
		}
	</style>
	<link rel="icon" type="__STATIC__/index/image/x-icon" href="__STATIC__/index/favicon.ico">
	<link rel="stylesheet" type="text/css" href="__STATIC__/index/css/aui.css"/>
	<link rel="stylesheet" type="text/css" href="__STATIC__/index/css/aui-slide.css"/>
    <link rel="stylesheet" href="__STATIC__/index/css/seckill.css">
	<link rel="stylesheet" type="text/css" href="__STATIC__/index/css/pop.css"/>
	<link rel="stylesheet" href="__STATIC__/index/css/swiper-4.3.5.min.css">
</head>
<body style="background:#fff">
<header class="aui-bar aui-bar-nav">
	<a class="aui-pull-left aui-btn" href="javascript:history.back(-1);">
		<span class="aui-iconfont aui-icon-left" style="font-weight:800"></span>
	</a>
	<div class="aui-title">商品详情</div>
	<!-- <a class="aui-pull-right aui-btn">
		<span class="aui-iconfont aui-icon-more" tapmode onclick="showPopup('top-right')" style="display:block; height:40px; line-height:40px;"></span>
	</a> -->
</header>
<div id="aui-slide2">
	<div class="aui-slide-wrap" style="height:100%;">
		<div class="swiper-container" style="height:100%;">
			<div class="swiper-wrapper">
				
			</div>
			<!-- 如果需要分页器 -->
			<div class="swiper-pagination"></div>
		</div>
	</div>
	<div class="aui-slide-page-wrap">
		<!--分页容器-->
	</div>
</div>
<div class="aui-title-text ">
	<a href="#">
		<h2 class="goods_desc">
			<!-- <i><img src="__STATIC__/index/image/l.png" alt=""></i>
			<span>促销</span>
			荣耀V9play全网通 标配版 3GB+32GB 幻夜黑 移动联通电信4G手机 双卡双待 -->
		</h2>
	</a>
	<div style="font-size:18px; font-weight:800; color:#f34347" class="price">￥1299.00
	</div>
	<div class="time_box" style="text-align:right; display: none;">
		<span class="time_text">距开始</span>&nbsp;
		<span class="day">0天</span>
		<span class="hour">0</span> :
		<span class="minutes">0</span> :
		<span class="second">0</span>
	</div>
</div>
<div class="div-border t-line"></div>
<div class="aui-title-shout t-line">
	<a href="javascript:$('.goods_parts_big_img').show();">
		<p class="goods_parts">
			<span class="goods_parts_img"></span>
			<span class="goods_parts_cont">【首单支付】首单立减15元</span>
		</p>
	</a>
</div>
<div class="div-border t-line"></div>
<section class="aui-content-padded t-line" style="margin:0">
	<div class="aui-card-list"></div>
</section>
<div class="div-border t-line"></div>
<div class="wrap" id="wrap">
	<ul class="tabClick">
		<li>商品介绍</li>
		<li>规格参数</li>
		<li>包装售后</li>
	</ul>
	<div class="lineBorder">
		<div class="lineDiv"></div>
	</div>
	<div class="tabCon">
		<div class="tabBox"></div>
	</div>
</div>
<div style="height:52px"></div>
<!-- 弹出 -->
<div class="flick-menu-mask"></div>
<div class="spec-menu">
	<div class="spec-menu-content spec-menu-show" style="display: block;">
		<div class="spec-menu-top bdr-b">
			<div class="spec-first-pic">
				<img id="spec_image" src="__STATIC__/index/image/sp1.jpg"/>
			</div>
			<a class="rt-close-btn-wrap spec-menu-close">
				<p class="flick-menu-close tclck">
					<i class="aui-iconfont aui-icon-close"></i>
				</p>
			</a>
			<div class="spec-price" id="specJdPri" style="display: block">
                        <span class="yang-pic spec-yang-pic">￥
                                        </span>
				<span id="spec_price">36.80 </span>
			</div>
			<div id="specWeightDiv" class="spec-weight">
				<span>重量:</span>
				<span id="spec_weight">3.26kg</span>
			</div>
		</div>
		<div class="spec-menu-middle">
			<div class="prod-spec" id="prodSpecArea">
				<!-- 已选 -->
				<div class="prod-spec" id="prodSpecArea">
					<!-- 已选 -->
					<div class="spec-desc">
						<span class="part-note-msg">已选</span>
						<div id="specDetailInfo_spec" class="base-txt">
							黑色  128GB &nbsp;&nbsp;<span class="amount">1</span>
							件

						</div>
					</div>
					<div class="nature-container" id="natureCotainer">
						<!--颜色 5.5版本之前的规格属性-->
						<div class="pro-color">
							<span class="part-note-msg">颜色 </span>
							<p id="color">
								<a title="金色" class="a-item selected J_ping" report-eventparam="金色">金色</a>
								<a title="玫瑰金色" class="a-item J_ping" report-eventparam="玫瑰金色">玫瑰金色</a>
								<a title="银色" class="a-item J_ping" report-eventparam="银色">银色</a>
								<a title="黑色" class="a-item J_ping" report-eventparam="黑色">黑色</a>
								<a title="亮黑色" class="a-item J_ping" report-eventparam="亮黑色">亮黑色</a>
								<a title="特别版红" class="a-item J_ping" report-eventparam="特别版红">特别版红</a>
							</p>
						</div>
						<div class="pro-color">
							<span class="part-note-msg">容量 </span>
							<p id="color1">
								<a title="16G" class="a-item selected J_ping" report-eventparam="16G">16G</a>
								<a title="32G" class="a-item J_ping" report-eventparam="32G">32G</a>
								<a title="64G" class="a-item J_ping" report-eventparam="64G">64G</a>
								<a title="128G" class="a-item J_ping" report-eventparam="128G">128G</a>
								<a title="256G" class="a-item J_ping" report-eventparam="256G">256G</a>
							</p>
						</div>
						<!--尺寸-->
						<!--容量-->
						<!--数量-->
					</div>
					<!--尺寸-->
					<!--容量-->
					<!--数量-->
					<div id="addCartNum" class="pro-count">
						<span class="part-note-msg" style="margin-right: 10px;">数量</span>
						<div style="width: 100%;margin-left: 10px;" class="num ">
							<p class="jian" style="float: left;margin-top: 5px; font-size:18px;">-
							</p>
							<input id="cool" class="inputBorder" value="1" onkeyup="this.value=this.value.replace(/[^0-9]/g,'')" onafterpaste="this.value=this.value.replace(/[^0-9]/g,'')" type="text" maxlength="5" placeholder="数量" style="font-size: 12px;width: 60px;height: 20px;float: left;padding: 0 5px;margin-top:3px;margin-left: 5px; text-align:center"/>
							<p class="jia" style="float: left;margin-top: 5px;font-size:18px; margin-left:4px;">+
							</p>
						</div>
					</div>
				</div>
			</div>
			<!--延保start-->
			<div class="warranty-wrap bdr-t">
				<div id="spec_yanbaoInfo" class="warranty-title">保障服务 </div>
				<div id="spec_yanbaoItems"></div>
			</div>
			<!--延保end-->
		</div>
	</div>
</div>
<!-- 弹出 -->
<footer class="aui-bar aui-bar-tab aui-margin-t-15  aui-border-t">
	<div class="aui-bar-tab-item" style="width: 2rem;">
		<a href="chat"><i class="aui-iconfont aui-icon-comment star_info" style="color:#757575;"></i></a>
		<div class="aui-bar-tab-label star_info">客服</div>
	</div>
	<div class="aui-bar-tab-item collection_add" tapmode style="width: 2rem;">
		<i class="aui-iconfont aui-icon-star star_info"></i>
		<div class="aui-bar-tab-label star_info">收藏</div>
	</div>
	<div class="aui-bar-tab-item" style="width: 2rem;">
		<a href="{:url('index/Shopping/index')}"><i class="aui-iconfont aui-icon-cart star_info" style="color:#757575"></i></a>
		<div class="aui-bar-tab-label star_info">购物车</div>
	</div>
	<div class="aui-bar-tab-item aui-bg-warning aui-text-white" tapmode style="border-top-left-radius: 18px;border-bottom-left-radius: 18px;" id="add_to_cart">加入购物车</div>
	<div class="aui-bar-tab-item aui-bg-danger aui-text-white" onclick="toUrl('order_index')" tapmode style="border-top-right-radius: 18px; border-bottom-right-radius: 18px;" id="buy_now">立即购买</div>
</footer>
<!-- 配件大图 -->
<div class="goods_parts_big_img">
	<a href="javascript:$('.goods_parts_big_img').hide();;">×</a>
	<div></div>
</div>
<script src="__STATIC__/index/js/swiper-4.3.5.min.js"></script>
<script type="text/javascript" src="__STATIC__/index/js/index/api.js"></script>
<script type="text/javascript" src="__STATIC__/index/js/index/aui-popup-new.js"></script>
<script type="text/javascript" src="__STATIC__/index/js/index/aui-slide.js"></script>
<script type="text/javascript" src="__STATIC__/index/js/index/aui-collapse.js"></script>
<script src="__STATIC__/index/js/index/jquery.min.js"></script>
<script src="__STATIC__/index/js/index/ratchet.min.js"></script>
<script>
	window.onscroll = function() {
		var scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;
		if(scrollTop >= 100){
			$('.tabClick').show();
		}else if(scrollTop == 0){
			$('.tabClick').hide();
		}
	}
	var xid;
	(function(){
		$.ajax({
			url: '{:url("index/Goods/detail")}',
			type: 'POST',
			dataType: 'JSON',
			async: false,
			success: function(data){
				console.log(data)
				var data = data.data[0];
				// 轮播图
				var img_len = data.goods_images.length;
				for(var i = 0; i < img_len; i++){
					if(data.goods_images[i] !== null){
						$('.swiper-wrapper').append('<div class="swiper-slide"><img src="__UPLOAD__/'+data.goods_images[i]+'"></div>');
					}							
				}
				// 标题
				var str = '';
				var sign_len = data.goods_sign.split(',').length;
				for(var i = 0; i < sign_len; i++){
					str += '<span>'+data.goods_sign.split(',')[i]+'</span>';
				}
				$('.goods_desc').html(str + data.goods_name+'');
				$('.goods_desc')[0].id = "desc_" + data.id;
				
				// 赠送配件说明
				$('.goods_parts_cont').html(data.goods_parts);
				$('.goods_parts_img').html('<img src="__UPLOADS__/'+data.goods_parts_img+'">')
				// 配件大图
				$('.goods_parts_big_img div').html('<img src="__UPLOADS__/'+data.goods_parts_big_img+'">');
				// 规格图片
				$('.aui-card-list').append('<img src="__UPLOADS__/'+data.goods_spec_img+'">')
				// 质检图
				$.each(data.goods_quality_img,function(idx, val){
					var str = '';
					if(val !== null){
						str += '<img src="__UPLOAD__/'+data.goods_quality_img[i]+'">';
					}
					$('.tabBox').append(str);
				})
				// 价格
				$('.price').html('￥'+data.goods_bottom_money+'');
				xid = data.id;
				if(data.start_time != undefined){
					$('.time_box').css('display','block');
					// 活动开始时间
					var start_time = data.start_time*1000;
					// 活动结束时间
					var over_time = data.over_time*1000;

					// 倒计时函数
					function count_down(obj){
						// 获取当前时间
						var curr_time = new Date().getTime();
						// 时间差
						var to_start = obj - curr_time;
						// 剩余多少天，小时，分钟，秒
						var Day = parseInt(to_start/1000/3600/24) < 10 ? '0'+parseInt(to_start/1000/3600/24) : parseInt(to_start/1000/3600/24);
						var Hour = parseInt(to_start/1000/3600%24) < 10 ? '0'+parseInt(to_start/1000/3600%24) : parseInt(to_start/1000/3600%24);
						var Minutes = parseInt(to_start/1000/60%60) < 10 ? '0'+parseInt(to_start/1000/60%60) : parseInt(to_start/1000/60%60);
						var Second = parseInt(to_start/1000%60) < 10 ? '0'+parseInt(to_start/1000%60):  parseInt(to_start/1000%60);
						// 渲染到页面上
						$('.hour')[0].innerHTML = Hour;
						$('.minutes')[0].innerHTML = Minutes;
						$('.second')[0].innerHTML = Second;
						// 如果天数不为0，显示标签
						if(Day != 0){
							$($('.day')[0]).css('display','inline-block');
							$('.day')[0].innerHTML = Day + '天';
						}
					}
					// 显示距离活动开始的时间
					if(start_time - new Date().getTime() > 0){
						$('.time_text')[0].innerHTML = '距开始';
						setInterval(function(){
							count_down(start_time);
						},1000)
					}else{
						// 显示 距离活动结束的时间
						$('.time_text')[0].innerHTML = '距结束';
						setInterval(function(){
							count_down(over_time);
						},1000)
					}
				}
//				$.ajax({
//					url: '{:url("index/Order/common_id")}',
//					type: 'POST',
//					dataType: 'JSON',
//					async: false,
//					data: {
//						'data': data
//					},
//					success: function(data){
//						console.log(111)
//						console.log(data);
//					},
//					error: function(){
//						console.log('错误');
//					}
//				})
			},
			error: function(){
				console.log('错误')
			}
		})
	})()
</script>
<script type="text/javascript">
    $(function () {
        $(".clickwn").click(function () {
            $(".flick-menu-mask").show();
            $(".spec-menu").show();
        })

        $(".tclck").click(function () {
            $(".flick-menu-mask").hide();
            $(".spec-menu").hide();
        })

		/* $("#cool").focus(function(){
		 var oi = $('#cool').val();

		 $('.amount').html(oi)
		 });*/

        $('#cool').bind('input propertychange', function () {
			/* alert(this.value);*/
            $('.amount').html(this.value)

        }).bind('input input', function () {

        });


        $('#color a').click(function () {
            var cook = $(this).index();
            $('#color a').eq(cook).addClass('selected').siblings().removeClass('selected');
        })

        $('#color1 a').click(function () {
            var cook = $(this).index();
            $('#color1 a').eq(cook).addClass('selected').siblings().removeClass('selected');
        })


        //加减面板
        $(function(){
            //加号
            $(".jia").click(function(){

                var $parent=$(this).parent(".num");
                var $num=window.Number($(".inputBorder",$parent).val());
                $(".inputBorder",$parent).val($num+1);

                $('.amount').html($num+1)

            });

            //减号
            $(".jian").click(function(){
                var $parent=$(this).parent(".num");
                var $num=window.Number($(".inputBorder",$parent).val());
                if($num>2){
                    $(".inputBorder",$parent).val($num-1);
                    $('.amount').html($num-1)

                }else{
                    $(".inputBorder",$parent).val(1);
                    $('.amount').html($num)
                }
            });

        })
    })
</script>
<script type="text/javascript">

    apiready = function () {
        api.parseTapmode();
    }
    var collapse = new auiCollapse({
        autoHide:false //是否自动隐藏已经展开的容器
    });

</script>

<script type="text/javascript">
	 var mySwiper = new Swiper ('.swiper-container', {
        direction: 'horizontal',
        loop: true,
        autoplay: true,
        delay: 3000,
        // 如果需要分页器
        pagination: {
            el: '.swiper-pagination',
        },
        // 如果需要滚动条
        scrollbar: {
            el: '.swiper-scrollbar',
        },
    });
    var slide2 = new auiSlide({
        container:document.getElementById("aui-slide2"),
        // "width":300,
        "height":290,
        "speed":300
    })
    // var slide3 = new auiSlide({
    //     container:document.getElementById("aui-slide3"),
    //     // "width":300,
    //     "height":240,
    //     "speed":500,
    //     "autoPlay": 3000, //自动播放
    //     "loop":true,
    //     "pageShow":true,
    //     "pageStyle":'line',
    //     'dotPosition':'center'
    // })
    // console.log(slide3.pageCount());
	
</script>
<!--获取陪同商品订单一起过来的用户id-->
<script>
	// 立即购买
	$("#buy_now").click(function () {
	    /*商品名*/
	    var goods_name = $('.goods_desc').html();
	    /*价格*/
	  	var price =  $('.price').html();

        $.ajax({
            type:'POST',
            url:'{:url("index/Order/common_id")}',
            dataType:'JSON',
			data:{
                "goods_name":goods_name,
                "price":price,
				'id': xid
			},
            success:function(data){
                console.log(data);
				location.href='order_index'
            },
            error: function(data){
                console.log('未登录');
                window.location.href ="login";
            }

        })
    });
	// 加入购物车
	$("#add_to_cart").click(function(){
		var myid = $('.goods_desc')[0].id.split('_')[1];
        $.ajax({
            type:'POST',
            url:'{:url("index/Shopping/ajax_id")}',
            dataType:'JSON',
			data:{
                'id':myid
			},
            success:function(data){
//                console.log(data);
                location.href='shopping_index';
            },
            error: function(){
                console.log('未登录');
                location.href='login';
            }

        })
    });
	//收藏
	$('.collection_add').click(function () {
        $.ajax({
            type:'POST',
            url:'{:url("index/Collection/add")}',
            dataType:'JSON',
            data:{
                'id': xid
            },
            success:function(data){
//                console.log(data);
				if(data.info == '收藏成功'){
					$('.collection_add').children().addClass('aui-text-warning');
				}else if(data.info == '取消收藏成功'){
					$('.collection_add').children().removeClass('aui-text-warning');
				}
            },
            error: function(){
                console.log('未登录');
                window.location.href ="login";
            }

        })
    });
</script>

<!--收藏按钮样式修改-->
<script>
        (function(){
            $.ajax({
                url: '{:url("index/Collection/show_collection")}',
                type: 'POST',
                dataType: 'JSON',
				'data':{
                    'id':xid
				},
                async: false,
                success: function(data){
//                   console.log(data);
				   if(data.data.status != null && data.data.status == 1){
					   $('.collection_add').children().addClass('aui-text-warning');
				   }
                },
                error: function(){
                    // console.log('未收藏')
                }
            })
        })()
</script>

<script>
	function toUrl(url){
        OCModel.share({'title': '立即购买跳转链接', 'desc': '跳转链接', 'shareUrl': url});
    }
</script>
</body>
</html>
